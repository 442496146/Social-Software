(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user-set-userinfo/user-set-userinfo"],{4355:function(e,t,r){"use strict";r.r(t);var n=r("6391"),i=r.n(n);for(var s in n)"default"!==s&&function(e){r.d(t,e,(function(){return n[e]}))}(s);t["default"]=i.a},6391:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r("4795")),i=s(r("5378"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return h(e)||f(e,t)||u(e,t)||o()}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){if(e){if("string"===typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)if(r.push(a.value),t&&r.length===t)break}catch(u){i=!0,s=u}finally{try{n||null==o["return"]||o["return"]()}finally{if(i)throw s}}return r}}function h(e){if(Array.isArray(e))return e}function l(e,t,r,n,i,s,a){try{var o=e[s](a),u=o.value}catch(c){return void r(c)}o.done?t(u):Promise.resolve(u).then(n,i)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function a(e){l(s,n,i,a,o,"next",e)}function o(e){l(s,n,i,a,o,"throw",e)}a(void 0)}))}}var p=["未知","男","女"],m=["秘密","未婚","已婚"],b=["秘密","学生","老师"],v=function(){Promise.all([r.e("common/vendor"),r.e("components/mpvue-citypicker/mpvueCityPicker")]).then(function(){return resolve(r("68d4"))}.bind(null,r)).catch(r.oe)},g={components:{mpvueCityPicker:v},data:function(){return{sexArr:p,qgArr:m,userpic:"",username:"",sex:0,qg:0,job:"",birthday:"",cityPickerValueDefault:[0,0,1],pickerText:""}},onLoad:function(){this.userpic=this.User.userinfo.userpic,this.username=this.User.userinfo.username,this.sex=this.User.userinfo.userinfo.sex||0,this.qg=this.User.userinfo.userinfo.qg||0,this.job=this.User.userinfo.userinfo.job||"请填写",this.birthday=this.User.userinfo.userinfo.birthday||"请填写",this.pickerText=this.User.userinfo.userinfo.path||"请填写"},onBackPress:function(){if(this.$refs.mpvueCityPicker.showPicker)return this.$refs.mpvueCityPicker.pickerCancel(),!0},onUnload:function(){this.$refs.mpvueCityPicker.showPicker&&this.$refs.mpvueCityPicker.pickerCancel()},computed:{startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate("end")}},methods:{showMulLinkageThreePicker:function(){this.$refs.mpvueCityPicker.show()},onConfirm:function(e){this.pickerText=e.label},bindDateChange:function(e){this.birthday=e.target.value},changeimg:function(){var t=this;return d(n.default.mark((function r(){var i,s,o,u,c,f,h,l;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.chooseImage({count:1,sizeType:["compressed"]});case 2:if(i=r.sent,s=a(i,2),s[0],o=s[1],o){r.next=8;break}return r.abrupt("return");case 8:return e.showLoading({title:"上传中...",mask:!1}),r.next=11,t.$http.upload("/edituserpic",{name:"userpic",filePath:o.tempFilePaths[0],token:!0,checkToken:!0});case 11:if(u=r.sent,c=a(u,2),f=c[0],h=c[1],l=JSON.parse(h.data),!f&&!l.errorCode){r.next=20;break}return e.showToast({title:l.msg?l.msg:"上传失败",icon:"none"}),e.hideLoading(),r.abrupt("return",!1);case 20:e.hideLoading(),e.showToast({title:"修改头像成功!"}),t.userpic=l.data,t.User.userinfo.userpic=t.userpic,e.setStorageSync("userinfo",t.User.userinfo);case 25:case"end":return r.stop()}}),r)})))()},changeOne:function(t){var r=this,n=[];switch(t){case"sex":n=p;break;case"qg":n=m;break;case"job":n=b;break}e.showActionSheet({itemList:n,success:function(e){switch(t){case"sex":r.sex=e.tapIndex;break;case"qg":r.qg=e.tapIndex;break;case"job":r.job=n[e.tapIndex];break}}})},submit:function(){var t=this;return d(n.default.mark((function r(){var s,o,u,c,f;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s={name:t.username,sex:t.sex,qg:t.qg,job:t.job,birthday:t.birthday,path:t.pickerText,age:i.default.gettime.getAgeByBirthday(t.birthday)},r.next=3,t.$http.post("/edituserinfo",s,{token:!0,checkToken:!0});case 3:if(o=r.sent,u=a(o,2),c=u[0],f=u[1],t.$http.errorCheck(c,f)){r.next=9;break}return r.abrupt("return");case 9:e.showToast({title:"修改成功！"}),t.User.userinfo.username=t.username,t.User.userinfo.userinfo=s,e.setStorageSync("userinfo",t.User.userinfo);case 13:case"end":return r.stop()}}),r)})))()},getDate:function(e){var t=new Date,r=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return"start"===e?r-=60:"end"===e&&(r+=2),n=n>9?n:"0"+n,i=i>9?i:"0"+i,"".concat(r,"-").concat(n,"-").concat(i)}}};t.default=g}).call(this,r("543d")["default"])},"688d":function(e,t,r){"use strict";var n=r("f149"),i=r.n(n);i.a},"7d88":function(e,t,r){"use strict";(function(e){r("a2a3");n(r("66fd"));var t=n(r("bfff"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("543d")["createPage"])},"8fa4":function(e,t,r){"use strict";var n,i=function(){var e=this,t=e.$createElement;e._self._c},s=[];r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return n}))},bfff:function(e,t,r){"use strict";r.r(t);var n=r("8fa4"),i=r("4355");for(var s in i)"default"!==s&&function(e){r.d(t,e,(function(){return i[e]}))}(s);r("688d");var a,o=r("f0c5"),u=Object(o["a"])(i["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);t["default"]=u.exports},f149:function(e,t,r){}},[["7d88","common/runtime","common/vendor"]]]);