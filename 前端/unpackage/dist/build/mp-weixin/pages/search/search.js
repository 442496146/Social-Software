(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{"17e9":function(t,e,n){"use strict";n.r(e);var i=n("4044"),r=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=r.a},4044:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n("4795"));function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){return d(t)||c(t,e)||a(t,e)||u()}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(t){if("string"===typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function c(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,r=!1,o=void 0;try{for(var u,a=t[Symbol.iterator]();!(i=(u=a.next()).done);i=!0)if(n.push(u.value),e&&n.length===e)break}catch(s){r=!0,o=s}finally{try{i||null==a["return"]||a["return"]()}finally{if(r)throw o}}return n}}function d(t){if(Array.isArray(t))return t}function f(t,e,n,i,r,o,u){try{var a=t[o](u),s=a.value}catch(c){return void n(c)}a.done?e(s):Promise.resolve(s).then(i,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function u(t){f(o,i,r,u,a,"next",t)}function a(t){f(o,i,r,u,a,"throw",t)}u(void 0)}))}}var h=function(){n.e("components/index/index-list").then(function(){return resolve(n("842e"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("components/common/no-thing").then(function(){return resolve(n("f137"))}.bind(null,n)).catch(n.oe)},m=function(){n.e("components/common/load-more").then(function(){return resolve(n("7456"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("components/news/topic-list").then(function(){return resolve(n("03d7"))}.bind(null,n)).catch(n.oe)},v=function(){n.e("components/user-list/user-list").then(function(){return resolve(n("908a"))}.bind(null,n)).catch(n.oe)},b={components:{indexList:h,noThing:p,loadMore:m,topicList:g,userList:v},data:function(){return{issearch:!1,loadtext:"上拉加载更多",list:[],searchtext:"",page:1,searchType:"post"}},onNavigationBarButtonTap:function(e){0==e.index&&t.navigateBack({delta:1})},onNavigationBarSearchInputChanged:function(t){this.searchtext=t.text},onNavigationBarSearchInputConfirmed:function(t){t.text&&this.getdata()},onReachBottom:function(){this.loadmore()},onPullDownRefresh:function(){this.getdata(),t.stopPullDownRefresh()},computed:{getPlaceholder:function(){var t="文章";return"post"==this.searchType?t="文章":"topic"==this.searchType?t="话题":"user"==this.searchType&&(t="用户"),"搜索"+t}},onLoad:function(e){e&&(this.searchType=e.searchType||"post",t.$on("updateData",this.updateData))},methods:{goBack:function(){t.navigateBack({delta:1})},updateData:function(t){switch(t.type){case"guanzhu":this.updateGuanZhu(t);break;case"support":this.updateSupport(t);break;case"updateComment":this.updateComment(t);break}},updateComment:function(t){var e=this.list.find((function(e){return e.id===t.post_id}));e&&e.commentnum++},updateSupport:function(t){var e=this.list.find((function(e){return e.id===t.post_id}));if(e){var n=e.infonum.index;e.infonum.index="ding"==t.do?1:2,0!==n&&(1==n?e.infonum.dingnum--:e.infonum.cainum--),0!==e.infonum.index&&(1==e.infonum.index?e.infonum.dingnum++:e.infonum.cainum++)}},updateGuanZhu:function(t){this.list.forEach((function(e,n){e.userid===t.userid&&(e.isguanzhu=t.data)}))},getdata:function(){var e=this;return l(i.default.mark((function n(){var r,u,a,s,c,d,f,l,h;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showLoading({title:"Loading..."}),r="/search/"+e.searchType,n.next=4,e.$http.post(r,{keyword:e.searchtext,page:e.page},{token:!0});case 4:if(u=n.sent,a=o(u,2),s=a[0],c=a[1],d=e.$http.errorCheck(s,c,(function(){t.hideLoading(),e.issearch=!0}),(function(){t.hideLoading(),e.issearch=!0})),d){n.next=11;break}return n.abrupt("return");case 11:for(f=[],l=c.data.data.list,console.log(c),h=0;h<l.length;h++)f.push(e.__format(l[h]));e.list=e.page>1?e.list.concat(f):f,e.issearch=!0,e.loadtext=l.length<10?"没有更多数据了":"上拉加载更多",t.hideLoading();case 19:case"end":return n.stop()}}),n)})))()},loadmore:function(){"上拉加载更多"==this.loadtext&&(this.loadtext="加载中...",this.page++,this.getdata())},__format:function(t){switch(this.searchType){case"post":return{userid:t.user.id,userpic:t.user.userpic,username:t.user.username,isguanzhu:!!t.user.fens.length,id:t.id,title:t.title,type:"img",titlepic:t.titlepic,video:!1,path:t.path,share:!!t.share,infonum:{index:t.support.length>0?t.support[0].type+1:0,dingnum:t.ding_count,cainum:t.cai_count},commentnum:t.comment_count,sharenum:t.sharenum,sex:t.user.userinfo.sex,age:t.user.userinfo.age};case"topic":return{id:t.id,titlepic:t.titlepic,title:t.title,desc:t.desc,totalnum:t.post_count,todaynum:t.todaypost_count};case"user":return{id:t.id,userpic:t.userpic,username:t.username,age:t.userinfo.age,sex:t.userinfo.sex,isguanzhu:!1}}}}};e.default=b}).call(this,n("543d")["default"])},"902b":function(t,e,n){"use strict";n.r(e);var i=n("ee88"),r=n("17e9");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);var u,a=n("f0c5"),s=Object(a["a"])(r["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],u);e["default"]=s.exports},a5b0:function(t,e,n){"use strict";(function(t){n("a2a3");i(n("66fd"));var e=i(n("902b"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},ee88:function(t,e,n){"use strict";var i={userList:function(){return n.e("components/user-list/user-list").then(n.bind(null,"908a"))}},r=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}))}},[["a5b0","common/runtime","common/vendor"]]]);